{{- if .Values.experimentalGcsFuse.enabled }}
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: {{ include "rpc.fullname"  . }}-data-volume-pvc
  {{- if .Values.experimentalGcsFuse.annotations }}
  annotations:
{{ toYaml .Values.experimentalGcsFuse.annotations | indent 4 }}
  {{- end }}
  labels:
    {{- include "rpc.labels" . | nindent 4 }}
spec:
  accessModes:
{{ toYaml .Values.experimentalGcsFuse.accessModes | indent 4 }}
  storageClassName: {{ default "csi-gcs" .Values.experimentalGcsFuse.storageClass }}
  resources:
    requests:
      storage: "{{ .Values.experimentalGcsFuse.storage }}"
  csi:
    driver: gcs.csi.ofek.dev
    volumeHandle: csi-gcs
    volumeAttributes:
      gid: "1000"
      uid: "1000"
      dirMode: "0775"
      fileMode: "0664"
      implicitDirs: "true"
{{- end -}}